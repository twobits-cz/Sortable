/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @license MIT
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define("Sortable",[],t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():window.Sortable=t()}(function(){"use strict";function t(t,n){this.el=t,this.options=n=n||{},n.group=n.group||Math.random(),n.handle=n.handle||null,n.draggable=n.draggable||t.children[0]&&t.children[0].nodeName||(/[uo]l/i.test(t.nodeName)?"li":"*"),n.ghostClass=n.ghostClass||"sortable-ghost",n.ghostInBottom=n.ghostInBottom||5,n.scrollableContainer=n.scrollableContainer||null,n.scrollableContainerArea=n.scrollableContainerArea||60,n.onAdd=e(this,n.onAdd||X),n.onUpdate=e(this,n.onUpdate||X),n.onRemove=e(this,n.onRemove||X),t[C]=n.group;for(var o in this)"_"===o.charAt(0)&&(this[o]=e(this,this[o]));i(t,"add",n.onAdd),i(t,"update",n.onUpdate),i(t,"remove",n.onRemove),i(t,"mousedown",this._onTapStart),i(t,"touchstart",this._onTapStart),N&&i(t,"selectstart",this._onTapStart),i(t,"dragover",this._onDragOver),i(t,"dragenter",this._onDragOver),O.push(this._onDragOver)}function e(t,e){var n=B.call(arguments,2);return e.bind?e.bind.apply(e,[t].concat(n)):function(){return e.apply(t,n.concat(B.call(arguments)))}}function n(t,e,n){if("*"===e)return t;if(t){n=n||x,e=e.split(".");var o=e.shift().toUpperCase(),i=new RegExp("\\s("+e.join("|")+")\\s","g"),r;do if(r=t.className,r&&r.baseVal&&(r=r.baseVal),!(""!==o&&t.nodeName!=o||e.length&&((" "+r+" ").match(i)||[]).length!=e.length))return t;while(t!==n&&(t=t.parentNode))}return null}function o(t){t.dataTransfer.dropEffect="move",t.preventDefault()}function i(t,e,n){t.addEventListener(e,n,!1)}function r(t,e,n){t.removeEventListener(e,n,!1)}function a(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(/\s+/g," ").replace(" "+e+" ","");t.className=o+(n?" "+e:"")}}function s(t,e,n){if(t&&t.style){if(void 0===n)return x.defaultView&&x.defaultView.getComputedStyle?n=x.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];t.style[e]=n+("string"==typeof n?"":"px")}}function l(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;r>i;i++)n(o[i],i);return o}return[]}function c(t){return t.draggable=!1}function h(){I=!1}function d(t,e,n){if(!(0>=n)){var o=10,i=n/o,r=e/i;p(t,i,o,r)}}function p(t,e,n,o){0!=e&&setTimeout(function(){t.scrollTop+=o,p(t,e-1,n,o)},n)}function u(t,e,n){var o=t.lastElementChild.getBoundingClientRect();return e.clientY-(o.top+o.height)>n}function g(t,e){return"object"==typeof t&&null!=t&&"object"==typeof e&&null!=e&&"string"==typeof t[C]&&t[C]===e[C]}var f,v,m,_,b,S,D,y,T,w,C="Sortable"+(new Date).getTime(),E=window,x=E.document,Y=E.parseInt,N=!!x.createElement("div").dragDrop,A=!!("ontouchstart"in window),I=!1,R=function(t,e){var n=x.createEvent("Event");return n.initEvent(t,!0,!0),n.item=e,n},X=function(){},B=[].slice,O=[];return t.prototype={constructor:t,_applyEffects:function(){a(f,this.options.ghostClass,!0)},_onTapStart:function(t){var e=t.touches&&t.touches[0],r=(e||t).target,a=this.options,s=this.el;if(a.handle&&(r=n(r,a.handle,s)),r=n(r,a.draggable,s),r&&"selectstart"==t.type&&"A"!=r.tagName&&"IMG"!=r.tagName&&r.dragDrop(),r&&!f&&r.parentNode===s){T=t,r.draggable=!0,l(r,"a",c),l(r,"img",c),e&&(T={target:r,clientX:e.clientX,clientY:e.clientY},this._onDragStart(T,!0),t.preventDefault()),i(this.el,"dragstart",this._onDragStart),i(this.el,"dragstart",this.options.onStart),i(this.el,"mouseup",this._onDrop),i(this.el,"dragend",this._onDrop),i(this.el,"dragend",this.options.onEnd),i(x,"dragover",o);try{x.selection?x.selection.empty():window.getSelection().removeAllRanges()}catch(h){}}},_emulateDragOver:function(){if(w){s(v,"display","none");var t=x.elementFromPoint(w.clientX,w.clientY),e=t,n=this.options.group,o=O.length;if(e)do{if(e[C]===n){for(;o--;)O[o]({clientX:w.clientX,clientY:w.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);s(v,"display","")}},_onTouchMoveStart:function(t){this.options.onStart(t),r(x,"touchmove",this._onTouchMoveStart)},_onTouchMove:function(t){if(T){var e=t.touches[0];w=e,s(v,"webkitTransform","translate3d("+(e.clientX-T.clientX)+"px,"+(e.clientY-T.clientY)+"px,0)")}},_onDragStart:function(t,e){var n=t.target,o=t.dataTransfer;if(m=this.el,f=n,_=n.nextSibling,y=this.options.group,e){var r=n.getBoundingClientRect(),a=s(n),l;v=n.cloneNode(!0),s(v,"top",n.offsetTop-Y(a.marginTop,10)),s(v,"left",n.offsetLeft-Y(a.marginLeft,10)),s(v,"width",r.width),s(v,"height",r.height),s(v,"opacity","0.8"),s(v,"position","absolute"),s(v,"zIndex","100000"),m.appendChild(v),l=v.getBoundingClientRect(),s(v,"width",2*r.width-l.width),s(v,"height",2*r.height-l.height),i(x,"touchmove",this._onTouchMove),i(x,"touchmove",this._onTouchMoveStart),i(x,"touchend",this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else o.effectAllowed="move",o.setData("Text",n.textContent),i(x,"drop",this._onDrop);this._scrollInterval=Date.now(),setTimeout(this._applyEffects)},_onDragOver:function(t){if(!I&&y===this.options.group&&(void 0===t.rootEl||t.rootEl===this.el)){var e=this.el,o=n(t.target,this.options.draggable,e);if(0===e.children.length||e.children[0]===v||g(o,f.parentNode)||e===t.target&&u(e,t,this.options.ghostInBottom))e.appendChild(f);else if(o&&o!==f&&void 0!==o.parentNode[C]){b!==o&&(b=o,S=s(o),D=o.getBoundingClientRect());var i=D,r=i.right-i.left,a=i.bottom-i.top,l=/left|right|inline/.test(S.cssFloat+S.display),c=(l?(t.clientX-i.left)/r:(t.clientY-i.top)/a)>.5,d=o.offsetWidth>f.offsetWidth,p=o.offsetHeight>f.offsetHeight,m=o.nextSibling,_;if(I=!0,setTimeout(h,30),_=l?o.previousElementSibling===f&&!d||c>.5&&d:o.nextElementSibling!==f&&!p||c>.5&&p,_&&!m)e.appendChild(f);else try{o.parentNode.insertBefore(f,_?m:o)}catch(T){}}this._detectScroll(t)}},_detectScroll:function(t){if(this.options.scrollableContainer&&!(Date.now()<this._scrollInterval+250)){this._scrollInterval=Date.now();var e=this.options.scrollableContainer,n=e.getBoundingClientRect().top+this.options.scrollableContainerArea,o=e.getBoundingClientRect().top+e.clientHeight-this.options.scrollableContainerArea-60;if(A){if(w.clientY>o){if(e.scrollHeight==e.scrollTop+e.clientHeight)return;d(e,100,200),T.clientY-=100,s(v,"webkitTransform","translate3d("+(touch.clientX-T.clientX)+"px,"+(touch.clientY-T.clientY)+"px,0)")}else if(w.clientY<n){if(0==e.scrollTop)return;d(e,-100,200),T.clientY+=100,s(v,"webkitTransform","translate3d("+(touch.clientX-T.clientX)+"px,"+(touch.clientY-T.clientY)+"px,0)")}}else t.clientY>o?d(e,100,200):t.clientY<n&&d(e,-100,200)}},_onDrop:function(t){this.options.onEnd&&this.options.onEnd(t),clearInterval(this._loopId),r(x,"drop",this._onDrop),r(x,"dragover",o),r(this.el,"mouseup",this._onDrop),r(this.el,"dragend",this._onDrop),r(this.el,"dragend",this.options.onEnd),r(this.el,"dragstart",this._onDragStart),r(this.el,"dragstart",this.options.onStart),r(this.el,"selectstart",this._onTapStart),r(x,"touchmove",this._onTouchMove),r(x,"touchend",this._onDrop),t&&(t.preventDefault(),t.stopPropagation(),v&&v.parentNode.removeChild(v),f&&(c(f),a(f,this.options.ghostClass,!1),m.contains(f)?f.nextSibling!==_&&f.dispatchEvent(R("update",f)):(m.dispatchEvent(R("remove",f)),f.dispatchEvent(R("add",f)))),m=f=v=_=T=w=b=S=y=null)},destroy:function(){var t=this.el,e=this.options;r(t,"add",e.onAdd),r(t,"update",e.onUpdate),r(t,"remove",e.onRemove),r(t,"mousedown",this._onTapStart),r(t,"touchstart",this._onTapStart),r(t,"selectstart",this._onTapStart),r(t,"dragover",this._onDragOver),r(t,"dragenter",this._onDragOver),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),O.splice(O.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},t.utils={on:i,off:r,css:s,find:l,bind:e,closest:n,toggleClass:a,checkExpandoEqual:g},t.version="0.1.9",t});